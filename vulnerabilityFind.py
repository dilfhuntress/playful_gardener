#!/usr/bin/python
import time
from urllib.request import urlopen
from bs4 import BeautifulSoup
import urllib3
import requests
import pandas
import webbrowser
import os


flag1 = True
while flag1:
    time.sleep(60)
    res = ""
    res2 = ""
    url = 'http://127.0.0.1:5000/forum'
    url2 = 'http://127.0.0.1:5000/articles'
    r = requests.get(url)
    r2 = requests.get(url2)
    soup = BeautifulSoup(r.text, features="html.parser")
    soup2 = BeautifulSoup(r2.text, features="html.parser")
    msg = soup.find_all('div', {'class': 'forum_msg'})
    art = soup2.find_all('div', {'class': 'article'})
    for el in msg:
        res = res + str(el.text.strip())
    for elem in art:
        res2 = res2 + str(elem.text)

    if res.find("redirect_uri=http://facebeak.com") != -1 or res2.find("redirect_uri=http://facebeak.com") != -1:
        webbrowser.open('file://' + os.path.realpath("flag.html"))
        flag1 = False
